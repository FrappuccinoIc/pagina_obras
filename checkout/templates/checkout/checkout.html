{% extends 'core/base.html' %}
{% load static %}

{% block contenido %}

<div class="container border border-2 p-3 px-5 rounded">
    <h1 class="mb-4 row">Confirmación de pedido</h1>
    <h3 class="row mb-4">A nombre de: {{ usuario.nombre }} {{ usuario.apellidos }}</h3>
    <div class="row mb-4 col-8">
        <label for="texto-direccion">Dirección: </label>
        <input type="text" name="texto-direccion" id="texto-direccion" required value="{{ usuario.direccion }}" form="form_sig">
    </div>
    <div id="empty-message" class="text-muted mb-3">
        {% if not lista_productos %}<h4>No hay productos en la lista.</h4>{% endif %}
    </div>
    {% for producto in lista_productos %}
    <div id="producto-{{ producto.id }}" class="row col-12 d-sm-inline-flex flex-row border-top py-3">
        <div class="container col-3">   
            <img class="img-fluid object-fit-cover ratio-1x1" src="{{ producto.imagen.url }}" alt="{{ producto.titulo }}">
        </div>
        <div class="row col-9">
            <h3 class="col-2">{{ producto.precio }}$</h3>
            <a href="{% url 'obra' producto.id %}" class="col-8"><h3>{{ producto.titulo }}</h3></a>
            <div class="col-1">
                <form method="POST"
                    hx-post="{% url 'quitar_en_checkout' %}"
                    hx-trigger="submit" 
                    hx-target="#producto-{{ producto.id }}"
                    hx-swap="outerHTML"
                >
                    {% csrf_token %}
                    <input type="text" name="producto" value="{{ producto.id }}" class="d-none">
                    <input type="submit" class="btn btn-danger" value="X">
                </form>
            </div>
        </div>
    </div>
    {% endfor %}
    <h2 id="cart-total" class="row text-center border-top mt-2 pt-3">Total: {{ monto_total }}</h2>
    <form action="#" id="form_sig">
        {% csrf_token %}
        <input id="boton-pago" type="submit" class="btn btn-primary row" {% if not lista_productos %}disabled{% endif %} value="Ir al siguiente paso >">
    </form>

    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</div>

{% endblock %}